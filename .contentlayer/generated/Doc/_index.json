[
  {
    "title": "How do server actions work under the hood?",
    "description": "A deep dive into how server actions work in the background, and undelying mechanisms that make it possible.",
    "published": true,
    "author": "zackozack",
    "featured": true,
    "publishedAt": "2025-01-30T00:00:00.000Z",
    "updatedAt": "2025-02-01T00:00:00.000Z",
    "tags": [
      "react",
      "nextjs",
      "server-actions",
      "nextjs-server-actions"
    ],
    "body": {
      "raw": "\n## What is a Server Action?\n\nA Server Action is an asynchronous function executed on the server, designed for handling data mutations (e.g., form submissions, API calls) directly from React components. It eliminates the need for separate API routes, enabling seamless integration of server-side logic with client-side interactions.\n\n<br />\n**Key features:**\n\n- **Progressive Enhancement:** Works even if JavaScript is disabled.\n- **Caching & Revalidation:** Integrates with Next.js caching (e.g., `revalidatePath`, `revalidateTag`).\n- **Security:** Uses encrypted IDs and CSRF protection by default.\n\n### How to Create a Server Action\n\nOne of the steps to create a server action is to create a file with `'use server'`. This tells Next.js to treat the file as a server action.\n\n```ts\n// app/actions.ts\n'use server';\nexport async function deletePost(postId: string) {\n  // Delete post from database\n  await db.post.delete({ where: { id: postId } });\n  revalidatePath('/posts'); // Update cache\n}\n```\n\nYou can then import and use it in your React client components.\n\n```tsx\n'use client';\nimport { deletePost } from '@/app/actions';\n\nexport function DeleteButton({ postId }: { postId: string }) {\n  return <button onClick={() => deletePost(postId)}>Delete</button>;\n}\n```\n\n## Internal Working\n\n<img src=\"/images/server-actions-under-the-hood/server-action-flow.png\" alt=\"Server Action Flow\" />\n\nWhen the Next.js codebase is compiled, the server actions are extracted and\n",
      "code": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty;var f=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),D=(l,e)=>{for(var r in e)c(l,r,{get:e[r],enumerable:!0})},s=(l,e,r,o)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of u(e))!B.call(l,t)&&t!==r&&c(l,t,{get:()=>e[t],enumerable:!(o=y(e,t))||o.enumerable});return l};var m=(l,e,r)=>(r=l!=null?p(g(l)):{},s(e||!l||!l.__esModule?c(r,\"default\",{value:l,enumerable:!0}):r,l)),A=l=>s(c({},\"__esModule\",{value:!0}),l);var i=f((b,a)=>{a.exports=_jsx_runtime});var F={};D(F,{default:()=>h,frontmatter:()=>C});var n=m(i()),C={title:\"How do server actions work under the hood?\",description:\"A deep dive into how server actions work in the background, and undelying mechanisms that make it possible.\",publishedAt:\"2025-01-30\",updatedAt:\"2025-02-01\",featured:!0,published:!0,author:\"zackozack\",tags:[\"react\",\"nextjs\",\"server-actions\",\"nextjs-server-actions\"]};function d(l){let e={a:\"a\",code:\"code\",figure:\"figure\",h2:\"h2\",h3:\"h3\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h2,{id:\"what-is-a-server-action\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#what-is-a-server-action\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"What is a Server Action?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"A Server Action is an asynchronous function executed on the server, designed for handling data mutations (e.g., form submissions, API calls) directly from React components. It eliminates the need for separate API routes, enabling seamless integration of server-side logic with client-side interactions.\"}),`\n`,(0,n.jsx)(\"br\",{}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Key features:\"})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Progressive Enhancement:\"}),\" Works even if JavaScript is disabled.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Caching & Revalidation:\"}),\" Integrates with Next.js caching (e.g., \",(0,n.jsx)(e.code,{children:\"revalidatePath\"}),\", \",(0,n.jsx)(e.code,{children:\"revalidateTag\"}),\").\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Security:\"}),\" Uses encrypted IDs and CSRF protection by default.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"how-to-create-a-server-action\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#how-to-create-a-server-action\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"How to Create a Server Action\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"One of the steps to create a server action is to create a file with \",(0,n.jsx)(e.code,{children:\"'use server'\"}),\". This tells Next.js to treat the file as a server action.\"]}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#1e1e2e\",color:\"#cdd6f4\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"catppuccin-mocha\",children:(0,n.jsxs)(e.code,{\"data-language\":\"ts\",\"data-theme\":\"catppuccin-mocha\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6C7086\",fontStyle:\"italic\"},children:\"// app/actions.ts\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#A6E3A1\"},children:\"'use server'\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" async\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" function\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\",fontStyle:\"italic\"},children:\" deletePost\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#EBA0AC\",fontStyle:\"italic\"},children:\"postId\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" string\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" {\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#6C7086\",fontStyle:\"italic\"},children:\"  // Delete post from database\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\"  await\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\" db\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\"post\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\",fontStyle:\"italic\"},children:\"delete\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"{\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\" where\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" {\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\" id\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\" postId \"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" }\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#89B4FA\",fontStyle:\"italic\"},children:\"  revalidatePath\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#A6E3A1\"},children:\"'/posts'\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"}),(0,n.jsx)(e.span,{style:{color:\"#6C7086\",fontStyle:\"italic\"},children:\" // Update cache\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"You can then import and use it in your React client components.\"}),`\n`,(0,n.jsx)(e.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,n.jsx)(e.pre,{style:{backgroundColor:\"#1e1e2e\",color:\"#cdd6f4\"},tabIndex:\"0\",\"data-language\":\"tsx\",\"data-theme\":\"catppuccin-mocha\",children:(0,n.jsxs)(e.code,{\"data-language\":\"tsx\",\"data-theme\":\"catppuccin-mocha\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#A6E3A1\"},children:\"'use client'\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" {\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\" deletePost \"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" from\"}),(0,n.jsx)(e.span,{style:{color:\"#A6E3A1\"},children:\" '@/app/actions'\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\"export\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" function\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\",fontStyle:\"italic\"},children:\" DeleteButton\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"({\"}),(0,n.jsx)(e.span,{style:{color:\"#EBA0AC\",fontStyle:\"italic\"},children:\" postId\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" }\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" {\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\",fontStyle:\"italic\"},children:\" postId\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" string\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" })\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\"  return\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\" <\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\"},children:\"button\"}),(0,n.jsx)(e.span,{style:{color:\"#F9E2AF\"},children:\" onClick\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"{()\"}),(0,n.jsx)(e.span,{style:{color:\"#CBA6F7\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\",fontStyle:\"italic\"},children:\" deletePost\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\"(postId)\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"}\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#CDD6F4\"},children:\"Delete\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\"</\"}),(0,n.jsx)(e.span,{style:{color:\"#89B4FA\"},children:\"button\"}),(0,n.jsx)(e.span,{style:{color:\"#94E2D5\"},children:\">\"}),(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#9399B2\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.h2,{id:\"internal-working\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#internal-working\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Internal Working\"]}),`\n`,(0,n.jsx)(\"img\",{src:\"/images/server-actions-under-the-hood/server-action-flow.png\",alt:\"Server Action Flow\"}),`\n`,(0,n.jsx)(e.p,{children:\"When the Next.js codebase is compiled, the server actions are extracted and\"})]})}function h(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(d,{...l})}):d(l)}return A(F);})();\n;return Component;"
    },
    "_id": "blogs/server-actions-under-the-hood.mdx",
    "_raw": {
      "sourceFilePath": "blogs/server-actions-under-the-hood.mdx",
      "sourceFileName": "server-actions-under-the-hood.mdx",
      "sourceFileDir": "blogs",
      "contentType": "mdx",
      "flattenedPath": "blogs/server-actions-under-the-hood"
    },
    "type": "Doc",
    "slug": "/blogs/server-actions-under-the-hood",
    "slugAsParams": "server-actions-under-the-hood"
  }
]